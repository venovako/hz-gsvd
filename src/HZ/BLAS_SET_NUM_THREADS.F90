INTEGER FUNCTION BLAS_SET_NUM_THREADS(NT)

#ifdef USE_MKL
  USE MKL_SERVICE
  IMPLICIT NONE
  INTEGER, INTENT(IN) :: NT

  BLAS_SET_NUM_THREADS = MKL_SET_NUM_THREADS_LOCAL(NT)
#else
  USE OMP_LIB
  IMPLICIT NONE
  INTEGER, INTENT(IN) :: NT

  BLAS_SET_NUM_THREADS = OMP_GET_NUM_THREADS()
  CALL OMP_SET_NUM_THREADS(NT)
#endif

END FUNCTION BLAS_SET_NUM_THREADS
